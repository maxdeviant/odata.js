var OData=function(){"use strict";var t,o,n,r,e,p,u,i,s,c,h,a,f,y=function(y){t=y,o=[],n="",r=[],e="asc",p=0,u=0,i="allpages",s=[],c=[],h=[],a=[],f="json",t.alwaysCount&&g("$inlinecount")},l=function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);return t},d=function(t){this.options={alwaysCount:!1,caseSensitive:!0},this.options=l(this.options,t),y(this.options)};d.prototype.url=function(t){return n=t,this},d.prototype.orderBy=function(t){return r.push(t),g("$orderby"),this},d.prototype.direction=function(t){switch(t.toLowerCase()){case"asc":case"ascending":d.prototype.ascending.apply(this);break;case"desc":case"descending":d.prototype.descending.apply(this);break;default:throw new Error("Unknown orderBy direction: `"+t+"`.")}return this},d.prototype.ascending=function(){return e="asc",this},d.prototype.asc=d.prototype.ascending,d.prototype.descending=function(){return e="desc",this},d.prototype.desc=d.prototype.descending,d.prototype.top=function(t){return 0>t?this:(p=t,g("$top"),this)},d.prototype.skip=function(t){return 0>t?this:(u=t,g("$skip"),this)},d.prototype.inlineCount=function(t){return i=t===!1||0===t||"none"===t?"none":"allpages",g("$inlinecount"),this},d.prototype.count=d.prototype.inlineCount,d.prototype.select=function(t){return s.push(t),g("$select"),this},d.prototype.filter=function(o){var n=function(){};n.prototype.startGroup=function(){return h.push("("),this},n.prototype.endGroup=function(){return h.push(")"),this},n.prototype.equal=function(t,o){return r(t,"eq",o),this},n.prototype.eq=n.prototype.equal,n.prototype.notEqual=function(t,o){return r(t,"ne",o),this},n.prototype.ne=n.prototype.notEqual,n.prototype.greaterThan=function(t,o){return r(t,"gt",o),this},n.prototype.gt=n.prototype.greaterThan,n.prototype.greaterThanOrEqual=function(t,o){return r(t,"ge",o),this},n.prototype.ge=n.prototype.greaterThanOrEqual,n.prototype.lessThan=function(t,o){return r(t,"lt",o),this},n.prototype.lt=n.prototype.lessThan,n.prototype.lessThanOrEqual=function(t,o){return r(t,"le",o),this},n.prototype.le=n.prototype.lessThanOrEqual,n.prototype.and=function(){return h.push("and"),this},n.prototype.or=function(){return h.push("or"),this},n.prototype.not=function(){return h.push("not"),this},n.prototype.add=function(t,o){return h.push(p(t,"add",o)),this},n.prototype.subtract=function(t,o){return h.push(p(t,"sub",o)),this},n.prototype.sub=n.prototype.subtract,n.prototype.multiply=function(t,o){return h.push(p(t,"mul",o)),this},n.prototype.mul=n.prototype.multiply,n.prototype.divide=function(t,o){return h.push(p(t,"div",o)),this},n.prototype.div=n.prototype.divide,n.prototype.modulo=function(t,o){return h.push(p(t,"mod",o)),this},n.prototype.mod=n.prototype.modulo,n.prototype.substringOf=function(o,n,r){return h.push(r||t.caseSensitive===!1?"substringof('"+n.toLowerCase()+"', tolower("+o+"))":"substringof('"+n+"', "+o+")"),this},n.prototype.startsWith=function(t,o){return h.push("startswith("+t+", '"+o+"')"),this},n.prototype.endsWith=function(t,o){return h.push("startswith("+t+", '"+o+"')"),this},n.prototype.length=function(t){return h.push("length("+t+")"),this},n.prototype.indexOf=function(t,o){return h.push("indexof("+t+", '"+o+"')"),this},n.prototype.replace=function(t,o,n){return h.push("replace("+t+", '"+o+"', '"+n+"')"),this},n.prototype.toLower=function(t){return h.push("tolower("+t+")"),this},n.prototype.toUpper=function(t){return h.push("toupper("+t+")"),this},n.prototype.trim=function(t){return h.push("trim("+t+")"),this},n.prototype.concat=function(t,o){var n=function(t){var o=-1===t[1].indexOf("concat(");return"concat("+t[0]+", "+(o?"'":"")+t[1]+(o?"'":"")+")"};if("undefined"==typeof t&&"undefined"==typeof o){for(var r=[],e=0;e<a.length;e+=2){var p=a.slice(e,e+2);if(1===p.length){r.push(n([n(r.splice(0,2)),p]));break}r.push(n(p))}h.push(r.pop())}else null!==t&&"undefined"==typeof o?a.push(t):(a.push(t),a.push(o));return this},n.prototype.year=function(t){return h.push("year("+t+")"),this},n.prototype.month=function(t){return h.push("month("+t+")"),this},n.prototype.day=function(t){return h.push("day("+t+")"),this},n.prototype.hour=function(t){return h.push("hour("+t+")"),this},n.prototype.minute=function(t){return h.push("minute("+t+")"),this},n.prototype.second=function(t){return h.push("second("+t+")"),this},n.prototype.round=function(t){return h.push("round("+t+")"),this},n.prototype.floor=function(t){return h.push("floor("+t+")"),this},n.prototype.ceiling=function(t){return h.push("ceiling("+t+")"),this},n.prototype.isOf=function(t,o){return h.push(null!==t&&"undefined"==typeof o?"isof('"+t+"')":"isof("+t+", '"+o+"')"),this},n.prototype.next=function(){return h.length>0&&g("$filter"),this}.bind(this);var r=function(t,o,n){h.push(null!==t&&"undefined"==typeof n?p(o,t):e(t,o,n))},e=function(t,o,n){return t+" "+o+" '"+n+"'"},p=function(t,o,n){return"string"==typeof o&&(o="'"+o+"'"),t+" "+o+(n?" "+n:"")};return typeof o!=typeof Function?this:o(new n)},d.prototype.expand=function(t){return c.push(t),g("$expand"),this},d.prototype.format=function(t){switch(t.toLowerCase()){case"atom":case"application/atom+xml":f="atom";break;case"xml":case"application/xml":f="xml";break;case"json":case"application/json":f="json";break;default:f="json"}return g("$format"),this},d.prototype.atom=function(){return d.prototype.format.apply(this,["atom"])},d.prototype.json=function(){return d.prototype.format.apply(this,["json"])},d.prototype.xml=function(){return d.prototype.format.apply(this,["xml"])},d.prototype.query=function(){var t,r=m();if(n){t="";for(var e in r)e&&r[e]&&(t+=e+"="+r[e]+"&");t.lastIndexOf("&")===t.length-1&&(t=t.slice(0,t.length-1))}else t={},o.forEach(function(o){t[o]=r[o]});return y(this.options),t};var g=function(t){o.push(t)},m=function(){var t={};return x(t),j(t),q(t),$(t),w(t),b(t),v(t),O(t),t},v=function(t){return r.length<1?t:(t.$orderby=r.join(",")+" "+e,t)},w=function(t){return t.$top=p,t},$=function(t){return t.$skip=u,t},b=function(t){return t.$inlinecount=i,t},x=function(t){return s.length<1?t:(t.$select=s.join(","),t)},j=function(t){return c.length<1?t:(t.$expand=c.join(","),t)},q=function(t){return t.$filter=h.join(" "),t},O=function(t){return t.$format=f,t};return d}();