var OData=function(){"use strict";var t,o,n,r,e,p,u,i,s,h,c,f,a=function(a){t=[],o="",n=[],r="asc",e=0,p=0,u="allpages",i=[],s=[],h=[],c=[],f="json",a.alwaysCount&&d("$inlinecount")},y=function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n]);return t},l=function(t){this.options={alwaysCount:!1},this.options=y(this.options,t),a(this.options)};l.prototype.url=function(t){return o=t,this},l.prototype.orderBy=function(t){return n.push(t),d("$orderby"),this},l.prototype.ascending=function(){return r="asc",this},l.prototype.asc=l.prototype.ascending,l.prototype.descending=function(){return r="desc",this},l.prototype.desc=l.prototype.descending,l.prototype.top=function(t){return 0>t?this:(e=t,d("$top"),this)},l.prototype.skip=function(t){return 0>t?this:(p=t,d("$skip"),this)},l.prototype.inlineCount=function(t){return u=t===!1||0===t||"none"===t?"none":"allpages",d("$inlinecount"),this},l.prototype.count=l.prototype.inlineCount,l.prototype.select=function(t){return i.push(t),d("$select"),this},l.prototype.filter=function(t){var o=function(){};o.prototype.equal=function(t,o){return n(t,"eq",o),this},o.prototype.eq=o.prototype.equal,o.prototype.notEqual=function(t,o){return n(t,"ne",o),this},o.prototype.ne=o.prototype.notEqual,o.prototype.greaterThan=function(t,o){return n(t,"gt",o),this},o.prototype.gt=o.prototype.greaterThan,o.prototype.greaterThanOrEqual=function(t,o){return n(t,"ge",o),this},o.prototype.ge=o.prototype.greaterThanOrEqual,o.prototype.lessThan=function(t,o){return n(t,"lt",o),this},o.prototype.lt=o.prototype.lessThan,o.prototype.lessThanOrEqual=function(t,o){return n(t,"le",o),this},o.prototype.le=o.prototype.lessThanOrEqual,o.prototype.and=function(){return h.push("and"),this},o.prototype.or=function(){return h.push("or"),this},o.prototype.not=function(){return h.push("not"),this},o.prototype.add=function(t,o){return h.push(e(t,"add",o)),this},o.prototype.subtract=function(t,o){return h.push(e(t,"sub",o)),this},o.prototype.sub=o.prototype.subtract,o.prototype.multiply=function(t,o){return h.push(e(t,"mul",o)),this},o.prototype.mul=o.prototype.multiply,o.prototype.divide=function(t,o){return h.push(e(t,"div",o)),this},o.prototype.div=o.prototype.divide,o.prototype.modulo=function(t,o){return h.push(e(t,"mod",o)),this},o.prototype.mod=o.prototype.modulo,o.prototype.substringOf=function(t,o){return h.push("substringof('"+o+"', "+t+")"),this},o.prototype.startsWith=function(t,o){return h.push("startswith("+t+", '"+o+"')"),this},o.prototype.endsWith=function(t,o){return h.push("startswith("+t+", '"+o+"')"),this},o.prototype.length=function(t){return h.push("length("+t+")"),this},o.prototype.indexOf=function(t,o){return h.push("indexof("+t+", '"+o+"')"),this},o.prototype.replace=function(t,o,n){return h.push("replace("+t+", '"+o+"', '"+n+"')"),this},o.prototype.toLower=function(t){return h.push("tolower("+t+")"),this},o.prototype.toUpper=function(t){return h.push("toupper("+t+")"),this},o.prototype.trim=function(t){return h.push("trim("+t+")"),this},o.prototype.concat=function(t,o){var n=function(t){var o=-1===t[1].indexOf("concat(");return"concat("+t[0]+", "+(o?"'":"")+t[1]+(o?"'":"")+")"};if("undefined"==typeof t&&"undefined"==typeof o){for(var r=[],e=0;e<c.length;e+=2){var p=c.slice(e,e+2);if(1===p.length){r.push(n([n(r.splice(0,2)),p]));break}r.push(n(p))}h.push(r.pop())}else null!==t&&"undefined"==typeof o?c.push(t):(c.push(t),c.push(o));return this},o.prototype.year=function(t){return h.push("year("+t+")"),this},o.prototype.month=function(t){return h.push("month("+t+")"),this},o.prototype.day=function(t){return h.push("day("+t+")"),this},o.prototype.hour=function(t){return h.push("hour("+t+")"),this},o.prototype.minute=function(t){return h.push("minute("+t+")"),this},o.prototype.second=function(t){return h.push("second("+t+")"),this},o.prototype.round=function(t){return h.push("round("+t+")"),this},o.prototype.floor=function(t){return h.push("floor("+t+")"),this},o.prototype.ceiling=function(t){return h.push("ceiling("+t+")"),this},o.prototype.isOf=function(t,o){return h.push(null!==t&&"undefined"==typeof o?"isof('"+t+"')":"isof("+t+", '"+o+"')"),this},o.prototype.next=function(){return h.length>0&&d("$filter"),this}.bind(this);var n=function(t,o,n){h.push(null!==t&&"undefined"==typeof n?e(o,t):r(t,o,n))},r=function(t,o,n){return t+" "+o+" '"+n+"'"},e=function(t,o,n){return"string"==typeof o&&(o="'"+o+"'"),t+" "+o+(n?" "+n:"")};return typeof t!=typeof Function?this:t(new o)},l.prototype.expand=function(t){return s.push(t),d("$expand"),this},l.prototype.format=function(t){switch(t.toLowerCase()){case"atom":case"application/atom+xml":f="atom";break;case"xml":case"application/xml":f="xml";break;case"json":case"application/json":f="json";break;default:f="json"}return d("$format"),this},l.prototype.atom=function(){return l.prototype.format.apply(this,["atom"])},l.prototype.json=function(){return l.prototype.format.apply(this,["json"])},l.prototype.xml=function(){return l.prototype.format.apply(this,["xml"])},l.prototype.query=function(){var n,r=m();if(o){n="";for(var e in r)e&&r[e]&&(n+=e+"="+r[e]+"&");n.lastIndexOf("&")===n.length-1&&(n=n.slice(0,n.length-1))}else n={},t.forEach(function(t){n[t]=r[t]});return a(this.options),n};var d=function(o){t.push(o)},m=function(){var t={};return b(t),j(t),q(t),$(t),v(t),x(t),g(t),O(t),t},g=function(t){return n.length<1?t:(t.$orderby=n.join(",")+" "+r,t)},v=function(t){return t.$top=e,t},$=function(t){return t.$skip=p,t},x=function(t){return t.$inlinecount=u,t},b=function(t){return i.length<1?t:(t.$select=i.join(","),t)},j=function(t){return s.length<1?t:(t.$expand=s.join(","),t)},q=function(t){return t.$filter=h.join(" "),t},O=function(t){return t.$format=f,t};return l}();